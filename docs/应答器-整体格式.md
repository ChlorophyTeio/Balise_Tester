# CTCS/ETCS 应答器报文定义与功能规范说明书

## 1. 应答器帧结构与变量定义
本节定义了应答器传输报文头（Header）的结构。

| 序号 | 变量名 | 位数 (Bits) | 变量作用与定义 |
| :--- | :--- | :--- | :--- |
| **1** | **Q_UPDOWN** | 1 | **信息传送的方向**<br>0 = 车对地 (Train to Track)<br>1 = 地对车 (Track to Train) |
| | **M_VERSION** | 7 | **语言/代码版本编号**<br>示例：0010000 = V1.0 |
| | **Q_MEDIA** | 1 | **信息传输媒介**<br>0 = 应答器 (Balise)<br>1 = 环线 (Loop) |
| | **N_PIG** | 3 | **本应答器在应答器组中的位置**<br>000 = 第1个 ... 111 = 第8个 |
| | **N_TOTAL** | 3 | **应答器组中所包含的应答器数量**<br>000 = 1个 ... 111 = 8个 |
| | **M_DUP** | 2 | **本应答器信息与前/后应答器信息的关系**<br>00 = 不同 (无复制)<br>01 = 与后一个相同 (复制下一应答器)<br>10 = 与前一个相同 (复制上一应答器) |
| | **M_MCOUNT** | 8 | **报文计数器 (0~255)**<br>*具体规则见下节* |
| | **NID_C** | 10 | **地区编号**<br>高7位 = 大区编号<br>低3位 = 分区编号 |
| | **NID_BG** | 14 | **应答器标识号 (ID)**<br>高6位 = 车站编号<br>低8位 = 应答器编号 |
| | **Q_LINK** | 1 | **应答器组的链接关系**<br>0 = 不被链接 (Unlinked)<br>1 = 被链接 (Linked) |
| **2** | **用户信息包** | 772 | **用户数据区** (包含具体的ETCS/CTCS数据包) |

### 1.1 报文计数器 (M_MCOUNT) 规则
根据系统定义，报文计数器的取值具有特定含义，用于校验报文的时效性和设备状态。

* **无源应答器 (Passive)**: `255`
* **有源应答器 (Active) 默认报文**: `252`
* **LEU 默认报文**: `0`
* **列控中心 (TCC) 默认报文**: `253`
* **列控中心 (TCC) 正常报文**: `255`
* **禁用值**: `254`
* **一致性校验原则**: 应答器组内，除 `M_MCOUNT=255` 的应答器外，其余各应答器报文计数器相同时，该消息才被视为可用。

---

## 2. 应答器类型与功能定义表
本节汇总了不同类型应答器在正向和反向运行时的功能及所含数据包。

### 2.1 常见的应答器类型

| 应答器类型 | 状态/场景 | 正向功能定义 | 包含信息包 (正向) | 反向功能定义 | 包含信息包 (反向) |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **ZJ2** | **有源** | 发送链接信息和临时限速 | ETCS-5, CTCS-2 | 发送链接信息和临时限速 | ETCS-5, CTCS-2 |
| | *故障* | 默认报文 (LEU/TCC故障) | - | - | - |
| | **无源** | 正向线路数据 | CTCS-1, ETCS-21/27/68/79 | - | - |
| **YG0/2** | 常规 | 链接、线路数据、等级转换预告 | ETCS-5/21/27/41, CTCS-1 | - | - |
| **FYG0/2** | 常规 | - | - | 链接、线路数据、等级转换预告 | ETCS-5/21/27/41, CTCS-1 |
| **ZX0/2** | 常规 | 链接、线路数据、等级转换执行 | ETCS-5/21/27/41, CTCS-1 | 线路数据、等级转换执行 | ETCS-21/27/41, CTCS-1 |
| **DD** | **无源** | 链接信息和线路数据 | ETCS-5/21/27, CTCS-1 | 发送链接信息 | ETCS-5 |
| | **有源** | 线路数据及大号码道岔信息 | CTCS-4 | - | - |
| | *补充* | 发送线路数据 | ETCS-27, CTCS-1 | - | - |
| **DC** | **无源** | 定位功能 | - | 定位功能 | - |
| | **调车关闭** | 发送调车危险信息 (有源) | ETCS-132 | 定位功能 | - |
| | **调车开放** | 定位功能 (有源) | - | 定位功能 | - |

### 2.2 进出站与特殊应答器

| 应答器类型 | 状态/场景 | 正向功能定义 | 包含信息包 (正向) | 反向功能定义 | 包含信息包 (反向) |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **ZJ1** | **无源** | - | - | 反向线路数据 | CTCS-1, ETCS-21/27/68/79 |
| | **发车开放** | - | - | 链接、发车进路、临时限速 | ETCS-5/27, CTCS-1/2 |
| | **发车关闭** | - | - | 绝对停车报文 | CTCS-5 |
| | **有源(其他)**| 链接、发车进路数据 | ETCS-5/27, CTCS-1 | - | - |
| | *故障* | - | - | C2: LEU/TCC故障 | - |
| | | - | - | 侧线出站故障: CTCS-5 | - |
| **FJZ** | 常规 | 链接、进路数据、临时限速 | ETCS-5/27/68, CTCS-1/2 | - | - |
| | **关闭(正向)**| 绝对停车报文 | CTCS-5 | - | - |
| | **反向发车** | - | - | 链接信息、临时限速 | ETCS-5, CTCS-2 |
| **CZ** | 常规 | 线路进路数据 | ETCS-21/27/79/132, CTCS-1 | 线路坡度信息 | ETCS-21 |
| | **正向发车** | 链接信息、临时限速 | ETCS-5, CTCS-2 | - | - |
| | **反向接车** | - | - | 链接信息、临时限速 | ETCS-5, CTCS-2 |
| | **反向侧向** | - | - | 链接、进路、临时限速 | ETCS-5/27, CTCS-1/2 |
| | **反向关闭** | - | - | 绝对停车报文 | CTCS-5 |
| **FCZ** | **无源** | 线路里程和坡度 | ETCS-21 | 线路坡度信息 | ETCS-21 |
| | **发车开放** | 链接、发车进路、临时限速 | ETCS-5/27, CTCS-1/2 | - | - |
| | **发车关闭** | 绝对停车报文 | CTCS-5 | - | - |
| | **反向通过** | - | - | 链接、发车进路 | ETCS-5/27, CTCS-1 |
| **Q** | 常规 | 链接、线路数据 | ETCS-5/21/27/68/79/72, CTCS-1 | 链接信息 | ETCS-5, ETCS-68 |
| **FQ** | 常规 | 定位功能 | - | 链接、线路数据 | ETCS-5/21/27/68, CTCS-1 |
| **JZ** | **无源** | 线路坡度信息 | ETCS-21 | 线路数据 | ETCS-21/27/68/79/132, CTCS-1 |
| | **进站开放** | 链接、临时限速 (正线) | ETCS-5, CTCS-2 | - | - |

---

## 3. 数据包有效范围定义
本节规定了应答器发送的数据包在列控系统中的有效作用距离。

### 3.1 区间闭塞分区应答器组

| 包名称 | 方向 | 数据范围 (作用域) |
| :--- | :--- | :--- |
| **链接信息 [ETCS-5]** | 正向 | 链接前方相邻的**两个**应答器组 |
| **链接信息 [ETCS-5]** | 反向 | 链接反方向相邻的**一个**应答器组 |
| **轨道区段 [CTCS-1]** | 正向 | 本应答器开始至前方第二个区间应答器组【Q】再延长一个制动距离 |
| **坡度/速度 [ETCS-21/27]** | 正向 | 与轨道区段数据范围一致 |
| **特殊区段 [ETCS-68]** | 正向 | 根据分相区信息发送原则发送 |
| **文本信息 [ETCS-72]** | 正向 | 进站前3个闭塞分区开始显示，出站进入区间后消失 |
| **位置信息 [ETCS-79]** | 双向 | 提供发送该信息的应答器的公里标 |

### 3.2 进站应答器组

| 包名称 | 场景 | 方向 | 数据范围 (作用域) |
| :--- | :--- | :--- | :--- |
| **临时限速 [CTCS-2]** | 接车/侧向 | 正向 | 依据《客运专线列控系统临时限速技术规范》 |
| **链接信息 [ETCS-5]** | 正线接车 | 正向 | 进站至区间第一架通过信号机范围内所有应答器组 |
| | 侧向接车 | 正向 | 链接至出站信号机(或出站口)范围内所有应答器组 |
| | 反向发车 | 反向 | 链接反方向相邻的第一个应答器组 |
| **轨道区段 [CTCS-1]** | 侧向接车 | 正向 | 至出站信号机(或出站口)再延伸一个制动距离 |
| **坡度数据 [ETCS-21]** | 正线接车 | 正向 | 进站至区间第一区间应答器组【Q】再加一个制动距离 |
| **速度数据 [ETCS-27]** | 正线接车 | 正向 | 与正向轨道区段数据范围一致 |
| **特殊区段 [ETCS-68]** | 接车/发车 | 双向 | 描述不同进路数据范围内距车站最近的分相区 |
| **里程信息 [ETCS-79]** | 无源 | 双向 | 应答器自身所在里程 |

### 3.3 出站应答器组

| 包名称 | 场景 | 方向 | 数据范围 (作用域) |
| :--- | :--- | :--- | :--- |
| **轨道区段 [CTCS-1]** | 发车 | 正向 | 至下行方向第一个区间应答器组【Q】再延长一个制动距离 |
| | 发车预告 | 反向 | 与发车轨道区段数据范围一致 |
| **链接信息 [ETCS-5]** | 发车 | 正向 | 出站至出站口应答器组范围内所有应答器组 |
| | 发车预告 | 反向 | 链接前方出站信号机应答器组及其范围内的所有应答器组 |
| **坡度/速度 [ETCS-21/27]** | 发车 | 正/反 | 与发车轨道区段数据范围一致 |
| **特殊区段 [ETCS-68]** | - | 正向 | 描述不同进路数据范围内距车站最近的分相区 |
| **里程信息 [ETCS-79]** | - | 双向 | 描述该应答器组自身里程信息 |

---

## 4. 附录：数据包代码对照表

* **CTCS-1**: 轨道区段信息 (Track Section Info)
* **CTCS-2**: 临时限速信息 (Temporary Speed Restriction)
* **CTCS-4**: 大号码道岔信息
* **CTCS-5**: 绝对停车报文 (Danger / Stop)
* **ETCS-5**: 链接信息 (Linking)
* **ETCS-21**: 坡度数据 (Gradient Profile)
* **ETCS-27**: 线路速度数据 (Static Speed Profile)
* **ETCS-41**: 等级转换信息 (Level Transition)
* **ETCS-68**: 特殊区段/分相区 (Track Condition)
* **ETCS-72**: 文本信息 (Text Message)
* **ETCS-79**: 地理位置信息 (Geographical Position)
* **ETCS-132**: 调车危险信息 (Danger for Shunting)